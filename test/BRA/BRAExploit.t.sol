// SPDX-License-Identifier:MIT
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import {BRAExploit} from "../../src/BRA/BRAExploit.sol";

// Reproducing BRA exploit in BNB chain
// https://twitter.com/CertiKAlert/status/1612674916070858753
// https://twitter.com/BlockSecTeam/status/1612701106982862849
// https://tx.eth.samczsun.com/binance/0x4e5b2efa90c62f2b62925ebd7c10c953dc73c710ef06695eac3f36fe0f6b9348

contract BRAExploitTest is Test {
    BRAExploit braExploit;

    function setUp() public {
        //Fork BSC chain at block 24656140  . Which is few blocks before the hack.

        vm.createSelectFork("https://bsc-dataseed.binance.org/", 24655000);
        braExploit = new BRAExploit();
    }

    function testExploit() public {
        uint256 bnbBalanceBefore = address(this).balance;
        braExploit.exploit();
        console.log(
            "Total profit:",
            (address(this).balance - bnbBalanceBefore)
        );
        assert(address(this).balance - bnbBalanceBefore > 0);
    }

    receive() external payable {
        // React to receiving ether
    }
}
